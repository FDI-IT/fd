{% load mainsearch %}

<fieldset id="formula">
<legend>Formula</legend>

<div id="content-solo">


	<form action="" method="POST">
	{{ management_form }}
	<table id="formula-rows" width="100%">
		<tr>
			<th>Ingredient number</th>
			<th>Amount</th>
			<th>Name</th>
			<th>Cost</th>
			<th>Del</th>
		</tr>

		{% for form, label, ingredient in formula_rows %}
			{% if ingredient not in resultant_objects %}
				<tr id = "alert-message" bgcolor="#FF0000">
    				<td colspan = "4"><b> Object does not meet the following criteria - </b>
    			
    			{% if art_nati_list %}
    				
    				{% for filter in art_nati_list %}
    					{% if ingredient.art_nati != filter %}
    						<b>Natural/Artificial:</b>{{ filter }} 
    					{% endif %}
    				{% endfor %}
    			{% endif %}
    			{% if allergen_list %}
    				 
    				{% for filter in allergen_list %}
    					{% if ingredient.allergen != filter %}
    						<b>Allergens:</b>{{ filter }} 
    					{% endif %}
    				{% endfor %}
    			{% endif %}
    			{% if prop65_list %}
    				 
    				{% for filter in prop65_list %}
    					{% if ingredient.prop65 != filter %}
    						<b>Contains Prop65:</b>{{ filter }}
    					{% endif %}
    				{% endfor %}
    			{% endif %}    			
    			</td></tr>
    		{% endif %}
		
		<tr>	
			<td class="number-cell">{{ form.ingredient_number.as_text }}</td>
			<td class="amount-cell">{{ form.amount.as_text }}</td>
			<td class="name-cell">{{ label.name }}</td>
			<td class="cost-cell">{{ label.cost }}</td>
			<td class="del-row"><input type="button" value="X" onclick="delete_row(this.parentNode.parentNode.rowIndex)"></td>
		</tr>
		{% endfor %}
	</table>
	<input id="add-formula-row-button" type="submit" value="Add row" />
	<input id="formula-submit-button" type="submit" value="Submit Formula" />		
	</form>
</fieldset>